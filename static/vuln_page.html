<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VTBO-2023-1</title>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <div class="container">
        <header class="vuln_header">
            <h1>XSS</h1>
            <p>ID: VTBO-2023-1</p>
            <div id="vuln_card_cvss">
                <p class="cvss_severity">Высокий</p>
                <p class="cvss_score">8.5</p>
                <p class="cvss_vector">CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H</p>
            </div>
            <p>Актуальна с релиза 17.9</p>
            <label>Номер в ITSM
                <input type="text" name="incident-number" id="incident-number">
            </label>

            <div class="btns_wrapper">
                <input type="button" class="btn" id="vulnPDF_btn" value="Создать pdf карточки уязвимости">
                <input type="button" class="btn" id="vulnPDFfromMD_btn" value="Создать pdf карточки уязвимости из md">
                <input type="button" class="btn" id="FalsePositive_btn" value="False positive">
                <input type="button" class="btn" id="delVuln_btn" value="">
                <a href="release_page.html" class="btn" id="add_vuln_btn">Назад</a>
            </div>
        </header>
    <div class="vuln_info">
        <div class="vuln_row">
            <label>Подробное описание
                <textarea name="vuln-description" cols="30" rows="2" required onkeyup="textAreaAdjust(this)">Возможность сделать SQLi</textarea>
            </label>
        </div>
        <div class="vuln_row">
            <label>Последствия эксплуатации
                <textarea name="vuln-consequences" cols="30" rows="2" required onkeyup="textAreaAdjust(this)">будет не очень</textarea>
            </label>
        </div>
        <div class="vuln_row">
            <label>Точка входа
                <textarea name="vuln-endpoints" cols="30" rows="2" required onkeyup="textAreaAdjust(this)">https://somwhere.com</textarea>
            </label>
        </div>
        <div class="vuln_row">
            <label>Рекомендации по устранению
                <textarea name="vuln-recommendation" cols="30" rows="2" required onkeyup="textAreaAdjust(this)">Лучше устранить</textarea>
            </label>
        </div>
        <div class="vuln_row discovery">
            <label> Где выявлено
                <select name="vuln-channel-application">
                    <option value="1" selected>Mobile Android</option>
                    <option value="2">Mobile iOS</option>
                    <option value="3">Web</option>
                    <option value="4">Web + Mobile</option>
                </select>
            </label>
        </div>
        <div class="vuln_row discovery">
            <label>Дата выявления
                <input type="date" id="start" required name="vuln-date-of-discovery"
                       value="2023-03-21"
                       min="2020-01-01" max="2099-12-31">
            </label>
        </div>
        <div class="vuln_row tags_container">
            <label>Классификация уязвимости (CWE, MASSVS)
                <div class="tag_container">
                    <div class="tag"><span>CWE-123 </span><closebtn class="close-icon" data-item="CWE-123 "></closebtn></div>
                    <div class="tag"><span>CWE-31 </span><closebtn class="close-icon" data-item="CWE-31 "></closebtn></div>
                    <input name="vuln-classification" type="text" data-role="taginput">
                </div>
            </label>
        </div>
        <div class="vuln_row tags_container">
            <label>Ссылка на источники
                <textarea name="class-link" id="source_links" cols="30" rows="2" required ></textarea>
            </label>
        </div>
    </div>


        <!--    <div class="row calc-cvss">-->
        <!--        <div id="score_rating">-->
        <!--            <input type="number" name="vuln-score-cvss" required id="cvss_score" disabled>-->
        <!--            <span id="cvss_severity">Score</span>-->
        <!--        </div>-->
        <!--        <input type="text" name="vuln-vector-cvss" required id="page_vector_string">-->
        <!--        <input type="button" value="Рассчитать CVSS 3.1" class="btn" id="cvss-button">-->
        <!--    </div>-->
        <details>
            <summary>Свидетельства обнаружения</summary>
            <form method="post" action="">
                <div class="row vulns-detail">
                    <h3>Свидетельства обнаружения</h3>
                    <input type="button" class="btn add_btn" value="Добавить блок" onclick="openModalAddBlock()">
                    <div class="description_block detail_block" draggable="true">
                        <div class="move_icon"></div>
                        <textarea data-i="descr-${i}" name="description-${i}" cols="30" rows="2" onkeyup="textAreaAdjust(this)"></textarea>
                        <input type="button" class="btn" required value="Добавить блок" onclick="openModalAddBlock()">
                        <div class="del_icon" onclick="this.parentElement.remove()"></div>
                    </div>
                    <div class="image_block detail_block" draggable="true">
                        <div class="move_icon"></div>
                        <div class="input__wrapper">
                            <input name="file-${i}" type="file" data-i="file_input-${i}" required accept=".jpg, .png, .gif" id="input__file-${i}" class="input input__file">
                            <label for="input__file-${i}" class="input__file-button btn">
                                <span class="input__file-icon-wrapper"><img class="input__file-icon" src="./img/iconfinder_download_down_save_8666778.svg" alt="Выбрать файл" width="25"></span>
                                <span class="input__file-button-text">Выберите файл</span>
                            </label>
                            <div class="preview_img_div"><img src="#" class="preview_img"></div>
                        </div>
                        <textarea name="image_descr-${i}" data-i="image_descr-${i}" cols="30" rows="2" required onkeyup="textAreaAdjust(this)"></textarea>
                        <input type="button" class="btn" value="Добавить блок" onclick="openModalAddBlock()">
                        <div class="del_icon" onclick="this.parentElement.remove()"></div>
                    </div>

                    <div id="detail-modal">
                        <div id="detail_modal_content">
                            <h3>Выбор блока</h3>
                            <label> Выберите тип блока
                                <select>
                                    <option value="description_block_option" selected>Описание</option>
                                    <option value="image_block_option">Изображение с подпиьсю</option>
                                </select>
                                <input type="button" class="btn" value="Добавить блок" onclick="addBlock(this.previousElementSibling)">
                            </label>
                        </div>
                    </div>
                </div>
                <input type="submit" value="Обновить свидетельства" class="btn">
            </form>
        </details>
        <details>
            <summary>Комментарии от владельцев</summary>
            <div class="row">
                <label>Результат решения по работам
                    <textarea name="vuln-recommendation" cols="30" rows="2" required onkeyup="textAreaAdjust(this)"></textarea>
                </label>
                <label>Ссылка на RDS/инцидент
                    <textarea name="vuln-recommendation" cols="30" rows="2" required onkeyup="textAreaAdjust(this)"></textarea>
                </label>
            </div>
            <div class="row">
                <label>Стрим ответственный за устранение
                    <textarea name="vuln-recommendation" cols="30" rows="2" required onkeyup="textAreaAdjust(this)"></textarea>
                </label>
                <label>Срок устранения
                    <input type="date" required name="vuln-date-of-discovery"
                           value="2023-03-21"
                           min="2020-01-01" max="2099-12-31">
                </label>
            </div>
            <div class="row">
                <label>ФИО ответственного
                    <textarea name="vuln-recommendation" cols="30" rows="2" required onkeyup="textAreaAdjust(this)"></textarea>
                </label>
                <label>Источник информациии
                    <textarea name="vuln-recommendation" cols="30" rows="2" required onkeyup="textAreaAdjust(this)"></textarea>
                </label>
            </div>
        </details>
    </div>

<script src="scripts/vuln_page_script.js"></script>
<script src="scripts/tags.js"></script>
</body>
</html>